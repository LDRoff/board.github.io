<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Интерактивная доска</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
</head>
<body>
    <div class="logo-container">
        <div id="logo"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /></svg></div>
        <div class="settings-menu" id="settingsMenu">
            <input type="file" id="imageUpload" accept="image/*" hidden>
            <input type="file" id="pdfUpload" accept=".pdf" hidden>
            <input type="file" id="projectUpload" accept=".board" hidden>
            <a href="#" id="saveProjectBtn">Сохранить проект</a>
            <a href="#" id="openProjectBtn">Открыть проект</a>
            <a href="#" id="exportJpgBtn">Экспорт в JPG</a>
            <a href="#" id="settingsBtn">Настройки</a>
            <a href="#" id="helpBtn">Справка</a>
            <a href="#" id="clearCanvas">Очистить доску</a>
        </div>
    </div>

    <canvas id="backgroundCanvas"></canvas>
    <canvas id="drawingBoard" tabindex="-1"></canvas>
    <canvas id="interactionCanvas"></canvas>

    <div id="floating-text-toolbar" class="floating-toolbar">
        <div class="dropdown-container" id="font-family-dropdown-container">
            
            <div class="desktop-only">
                <button id="font-family-dropdown-btn" class="toolbar-select" data-action="font-family-dropdown" title="Шрифт">
                    <span id="font-family-display">Arial</span>
                    <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
            </div>

            <div class="mobile-only">
                <button id="mobile-font-family-dropdown-btn" data-action="font-family-dropdown" title="Шрифт">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M10.2,4.5L5,19h2.3l1.1-3h5.2l1.1,3h2.3L12.8,4.5h-2.6z M8.9,14.5l1.6-4.5l1.6,4.5H8.9z M20,19v-5.2c0-1.4-0.8-2.3-2.3-2.3c-1.5,0-2.3,0.9-2.3,2.3v0.7h1.5v-0.7c0-0.7,0.3-1,0.8-1s0.8,0.3,0.8,1v1c-1-0.3-2,0-2.6,0.6C15.3,14.9,15,15.7,15,16.8V19h1.5v-2.2c0-0.8,0.3-1.1,0.8-1.1c0.5,0,0.8,0.3,0.8,1.1V19H20z"/>
                    </svg>
                </button>
            </div>
            
            <div class="dropdown-options font-options" id="font-family-options">
                <button data-font="Arial" style="font-family: Arial;">Arial</button>
                <button data-font="Georgia" style="font-family: Georgia;">Georgia</button>
                <button data-font="Times New Roman" style="font-family: 'Times New Roman';">Times New Roman</button>
                <button data-font="Verdana" style="font-family: Verdana;">Verdana</button>
                <button data-font="Courier New" style="font-family: 'Courier New';">Courier New</button>
            </div>
        </div>

        <input type="number" id="floatingFontSizeInput" class="toolbar-font-size" min="1" max="200" value="30" title="Размер шрифта">
        <div class="toolbar-separator desktop-only"></div>

        <button data-action="font-bold" title="Полужирный" class="desktop-only">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M8 11H13.5C14.3284 11 15 11.6716 15 12.5C15 13.3284 14.3284 14 13.5 14H8V11ZM8 6H12.5C13.3284 6 14 6.67157 14 7.5C14 8.32843 13.3284 9 12.5 9H8V6ZM6 4V16H13.5C15.433 16 17 14.433 17 12.5C17 10.8123 15.8099 9.3802 14.25 9.0625C15.441 8.53906 16 7.35938 16 6.5C16 4.567 14.433 4 12.5 4H6Z"/></svg>
        </button>
        <button data-action="font-italic" title="Курсив" class="desktop-only">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4V7H12.21L8.79 15H6V18H14V15H11.79L15.21 7H18V4H10Z"/></svg>
        </button>
        <button data-action="font-underline" title="Подчеркнутый" class="desktop-only">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M8 3V11C8 13.2091 9.79086 15 12 15C14.2091 15 16 13.2091 16 11V3H18V11C18 14.3137 15.3137 17 12 17C8.68629 17 6 14.3137 6 11V3H8ZM4 19H20V21H4V19Z"/></svg>
        </button>
        <div class="toolbar-separator desktop-only"></div>
        <button data-action="align-left" title="По левому краю" class="desktop-only">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H21V6H3V4ZM3 9H15V11H3V9ZM3 14H21V16H3V14ZM3 19H15V21H3V19Z"/></svg>
        </button>
        <button data-action="align-center" title="По центру" class="desktop-only">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H21V6H3V4ZM7 9H17V11H7V9ZM3 14H21V16H3V14ZM7 19H17V21H7V19Z"/></svg>
        </button>
        <button data-action="align-right" title="По правому краю" class="desktop-only">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H21V6H3V4ZM9 9H21V11H9V9ZM3 14H21V16H3V14ZM9 19H21V21H9V19Z"/></svg>
        </button>
        
        <div class="mobile-only dropdown-container" id="style-dropdown-container">
            <button id="style-dropdown-btn" data-action="style-dropdown" title="Стиль текста">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M8 11H13.5C14.3284 11 15 11.6716 15 12.5C15 13.3284 14.3284 14 13.5 14H8V11ZM8 6H12.5C13.3284 6 14 6.67157 14 7.5C14 8.32843 13.3284 9 12.5 9H8V6ZM6 4V16H13.5C15.433 16 17 14.433 17 12.5C17 10.8123 15.8099 9.3802 14.25 9.0625C15.441 8.53906 16 7.35938 16 6.5C16 4.567 14.433 4 12.5 4H6Z"/></svg>
            </button>
            <div class="dropdown-options" id="style-options">
                <button data-action="font-bold" title="Полужирный"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M8 11H13.5C14.3284 11 15 11.6716 15 12.5C15 13.3284 14.3284 14 13.5 14H8V11ZM8 6H12.5C13.3284 6 14 6.67157 14 7.5C14 8.32843 13.3284 9 12.5 9H8V6ZM6 4V16H13.5C15.433 16 17 14.433 17 12.5C17 10.8123 15.8099 9.3802 14.25 9.0625C15.441 8.53906 16 7.35938 16 6.5C16 4.567 14.433 4 12.5 4H6Z"/></svg></button>
                <button data-action="font-italic" title="Курсив"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4V7H12.21L8.79 15H6V18H14V15H11.79L15.21 7H18V4H10Z"/></svg></button>
                <button data-action="font-underline" title="Подчеркнутый"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M8 3V11C8 13.2091 9.79086 15 12 15C14.2091 15 16 13.2091 16 11V3H18V11C18 14.3137 15.3137 17 12 17C8.68629 17 6 14.3137 6 11V3H8ZM4 19H20V21H4V19Z"/></svg></button>
            </div>
        </div>
        <div class="mobile-only dropdown-container" id="align-dropdown-container">
            <button id="align-dropdown-btn" data-action="align-dropdown" title="Выравнивание текста">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H21V6H3V4ZM3 9H15V11H3V9ZM3 14H21V16H3V14ZM3 19H15V21H3V19Z"></path></svg>
            </button>
            <div class="dropdown-options" id="align-options">
                <button data-action="align-left" title="По левому краю"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H21V6H3V4ZM3 9H15V11H3V9ZM3 14H21V16H3V14ZM3 19H15V21H3V19Z"/></svg></button>
                <button data-action="align-center" title="По центру"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H21V6H3V4ZM7 9H17V11H7V9ZM3 14H21V16H3V14ZM7 19H17V21H7V19Z"/></svg></button>
                <button data-action="align-right" title="По правому краю"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H21V6H3V4ZM9 9H21V11H9V9ZM3 14H21V16H3V14ZM9 19H21V21H9V19Z"/></svg></button>
            </div>
        </div>
        <div class="toolbar-separator"></div>
        <div id="floating-color-picker" class="color-picker-wrapper">
             <button data-action="pick-color" title="Цвет текста">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10" stroke="#888" stroke-width="1.5" />
                </svg>
            </button>
            <div id="floatingColorPalette" class="floating-palette">
            </div>
        </div>
        <div class="toolbar-separator"></div>
        <button data-action="delete" title="Удалить">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M7 6V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7ZM9 4V6H15V4H9Z"></path></svg>
        </button>
    </div>

    <div id="floating-selection-toolbar" class="floating-toolbar">
        <button data-action="delete" title="Удалить">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M7 6V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7ZM9 4V6H15V4H9Z"></path></svg>
        </button>
    </div>
    
    <div id="floating-pdf-toolbar" class="floating-toolbar">
        <button data-action="prev-page" title="Предыдущая страница">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
        </button>
        <div id="pdf-page-indicator" style="font-size: 14px; color: var(--text-primary); white-space: nowrap;">1 / 1</div>
        <button data-action="next-page" title="Следующая страница">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
        </button>
        <div class="toolbar-separator"></div>
        <button data-action="delete" title="Удалить">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M7 6V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7ZM9 4V6H15V4H9Z"></path></svg>
        </button>
    </div>

    <div class="zoom-controls" id="zoomControls">
        <button id="zoomInBtn" title="Приблизить (+)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg></button>
        <button id="zoomOutBtn" title="Отдалить (-)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14" /></svg></button>
        <button id="panBtn" data-tool="pan" title="Перемещение (H)">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 13v-2.5a1.5 1.5 0 0 1 3 0v1.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M11 8.5v-1a1.5 1.5 0 0 1 3 0v1.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M14 10.5a1.5 1.5 0 0 1 3 0v1.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M17 11.5a1.5 1.5 0 0 1 3 0v4.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7l-.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47" />
            </svg>
        </button>
    </div>

    <div class="toolbar-wrapper" id="toolbarWrapper">
        <button class="toggle-toolbar" id="toggleToolbar" title="Свернуть/развернуть панель">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
            </svg>
        </button>
        <div class="toolbar-content-slider">
            <div id="drawingSubToolbar" class="sub-toolbar hidden">
                <button id="expandSubToolbarBtn" title="Настройки кисти">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
                    </svg>
                </button>
                <div class="sub-toolbar-content desktop-only">
                    <div class="color-palette" id="colorPalette">
                        <div class="color-dot active" style="background-color: #000000;" data-color="#000000"></div>
                        <div class="color-dot" style="background-color: #FFFFFF;" data-color="#FFFFFF"></div>
                        <div class="color-dot" style="background-color: #EF4444;" data-color="#EF4444"></div>
                        <div class="color-dot" style="background-color: #F97316;" data-color="#F97316"></div>
                        <div class="color-dot" style="background-color: #EAB308;" data-color="#EAB308"></div>
                        <div class="color-dot" style="background-color: #22C55E;" data-color="#22C55E"></div>
                        <div class="color-dot" style="background-color: #3B82F6;" data-color="#3B82F6"></div>
                        <div class="color-dot" style="background-color: #8B5CF6;" data-color="#8B5CF6"></div>
                    </div>
                    <div class="size-editor">
                        <input type="range" id="lineWidthSlider" min="1" max="50" value="3">
                    </div>
                    <div class="toolbar-separator"></div>
                    <div class="line-style-options" id="lineStyleOptions">
                        <button data-style="solid" class="active" title="Сплошная линия">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14"></path></svg>
                        </button>
                        <button data-style="dashed" title="Пунктирная линия">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-dasharray="4 4"><path d="M5 12h14"></path></svg>
                        </button>
                        <button data-style="dash-dot" title="Пунктир-точка">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                                <path d="M5 12h14" stroke-dasharray="8 4 1 4"></path>
                            </svg>
                        </button>
                        <button data-style="wavy" title="Волнистая линия">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12c3-3 5-3 8 0s5 3 8 0"></path></svg>
                        </button>
                    </div>
                </div>
                <div class="sub-toolbar-content mobile-only" id="mobileDrawingSubToolbar">
                    <div class="dropdown-container" id="mobile-color-container">
                        <button id="mobileColorBtn" title="Цвет">
                            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="#000000" stroke="#888" stroke-width="1.5"/></svg>
                        </button>
                        <div class="sub-toolbar-dropdown color-palette" id="mobileColorPalette">
                        </div>
                    </div>
                    <div class="dropdown-container" id="mobile-width-container">
                        <button id="mobileWidthBtn" title="Толщина линии">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20,18H4V20H20V18M20,10H4V16H20V10M20,4H4V8H20V4Z"></path></svg>
                        </button>
                        <div class="sub-toolbar-dropdown" id="mobileWidthDropdown">
                             <input type="range" id="mobileLineWidthSlider" min="1" max="50" value="3">
                        </div>
                    </div>
                    <div class="dropdown-container" id="mobile-style-container">
                        <button id="mobileStyleBtn" title="Стиль линии">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14"></path></svg>
                        </button>
                        <div class="sub-toolbar-dropdown line-style-options" id="mobileLineStyleOptions">
                        </div>
                    </div>
                </div>
            </div>
            <div class="toolbar-container">
                <div class="toolbar-drag-handle"></div>
                <div class="toolbar" id="toolbar">
                    <button id="undoBtn" title="Отменить (Ctrl+Z)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3" /></svg></button>
                    <button id="redoBtn" title="Повторить (Ctrl+Y)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m15 15 6-6m0 0-6-6m6 6H9a6 6 0 0 0 0 12h3" /></svg></button>
                    <div class="toolbar-separator"></div>
                    <button data-tool="select" title="Выделить (V)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="m4 4 7.07 17 2.51-7.39L21 11.07z"/></svg></button>
                    <button data-tool="brush" class="active" title="Кисть (B)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125" /></svg></button>
                    <button data-tool="smart-brush" title="Умная кисть (B)">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15.22 5.22a.75.75 0 011.06 0l2.5 2.5a.75.75 0 010 1.06l-10.5 10.5a.75.75 0 01-1.06 0l-2.5-2.5a.75.75 0 010-1.06l10.5-10.5z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M14.16 6.16L17.84 9.84" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 15v4M17 17h4" />
                        </svg>
                    </button>
                    <button data-tool="eraser" title="Ластик (E)" id="eraserBtn"><svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.5A4.5 4.5 0 0116.5 18H7.5A4.5 4.5 0 013 13.5V10.5A4.5 4.5 0 017.5 6h9A4.5 4.5 0 0121 10.5v3z" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16.5 18V6" stroke-linecap="round" stroke-linejoin="round"></path></svg></button>
                    <div class="tool-container" id="shapes-2d-tool-container">
                        <button id="shapes2DBtn" data-tool-group="shapes" title="2D Фигуры (S)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v16.5h16.5V3.75H3.75z" /></svg></button>
                        <div class="tool-options" id="shapes2DOptions">
                            <a href="#" data-tool="rect"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v16.5h16.5V3.75H3.75z" /></svg><span>Прямоугольник</span></a>
                            <a href="#" data-tool="ellipse"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg><span>Эллипс</span></a>
                            <a href="#" data-tool="line"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75 20.25 20.25" /></svg><span>Линия</span></a>
                            <a href="#" data-tool="parallelogram"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m4 20 4-16h12l-4 16H4z" /></svg><span>Параллелограмм</span></a>
                            <a href="#" data-tool="triangle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 2 L2 22 H22 Z" /></svg><span>Треугольник</span></a>
                            <a href="#" data-tool="trapezoid"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 20h18L16 4H8L3 20z" /></svg><span>Трапеция</span></a>
                             <a href="#" data-tool="rhombus"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 2L22 12 12 22 2 12 12 2Z" /></svg><span>Ромб</span></a>
                        </div>
                    </div>
                    <div class="tool-container" id="shapes-3d-tool-container">
                        <button id="shapes3DBtn" data-tool-group="shapes" title="3D Фигуры (D)"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" /></svg></button>
                        <div class="tool-options" id="shapes3DOptions">
                            <a href="#" data-tool="sphere"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M3.5 12a8.5 8.5 0 0 1 17 0" /></svg><span>Сфера</span></a>
                            <a href="#" data-tool="cone"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 2 L4 21 H20 Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M4 21a8 2 0 0 0 16 0" /></svg><span>Конус</span></a>
                            <a href="#" data-tool="parallelepiped"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" /></svg><span>Параллелепипед</span></a>
                            <a href="#" data-tool="pyramid">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 2.25L4.5 21h15L12 2.25z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 2.25v18.75" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 21l7.5-6 7.5 6" />
                                </svg>
                                <span>Пирамида</span>
                            </a>
                            <a href="#" data-tool="frustum"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4 21 L8 4 H16 L20 21 Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M8 4 a4 1.5 0 0 0 8 0" /><path stroke-linecap="round" stroke-linejoin="round" d="M4 21 a8 2 0 0 0 16 0" /></svg><span>Усеченный конус</span></a>
                            <a href="#" data-tool="truncated-pyramid"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4 20 l3-14 h10 l3 14 H4z M6.5 10 h11" /></svg><span>Усеченная пирамида</span></a>
                            <a href="#" data-tool="truncated-sphere">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 12.75C20.25 17.1391 16.5391 20.625 12 20.625C7.46094 20.625 3.75 17.1391 3.75 12.75" />
                                    <ellipse cx="12" cy="12.75" rx="8.25" ry="3.75"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="2 2" d="M12 3v9.75" />
                                </svg>
                                <span>Усеченная сфера</span>
                            </a>
                        </div>
                    </div>
                    <button data-tool="text" title="Текст (T)">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 3h12M12 3v18" />
                        </svg>
                    </button>
                    <div class="tool-container" id="add-file-tool-container">
                        <button id="addFileBtn" data-tool-group="files" title="Добавить файл">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48" />
                            </svg>
                        </button>
                        <div class="tool-options" id="addFileOptions">
                            <a href="#" id="addImageMenuBtn">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" /></svg>
                                <span>Изображение</span>
                            </a>
                            <a href="#" id="addPdfMenuBtn">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                                </svg>
                                <span>PDF-документ</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="settingsModal" class="modal-overlay hidden">
        <div class="modal-photoshop">
            <div class="modal-sidebar">
                <button class="sidebar-button active" data-panel="interface-panel">Интерфейс</button>
            </div>
            <div class="modal-main">
                <div class="modal-panel active" id="interface-panel">
                    <h3>Интерфейс</h3>
                    <div class="setting-row">
                        <label>Цветовая тема:</label>
                        <div class="ps-dropdown-container" id="theme-dropdown-container">
                            <button class="ps-select" id="theme-select-btn" data-value="light">Светлая</button>
                            <div class="ps-dropdown-options">
                                <button class="ps-dropdown-option active" data-value="light">Светлая</button>
                                <button class="ps-dropdown-option" data-value="dark">Темная</button>
                            </div>
                        </div>
                    </div>
                    <div class="setting-row">
                        <label>Стиль фона:</label>
                        <div class="ps-dropdown-container" id="background-style-dropdown-container">
                            <button class="ps-select" id="background-style-select-btn" data-value="dot">В точку</button>
                            <div class="ps-dropdown-options">
                                <button class="ps-dropdown-option active" data-value="dot">В точку</button>
                                <button class="ps-dropdown-option" data-value="grid">В клетку</button>
                            </div>
                        </div>
                    </div>
                    <div class="setting-row">
                        <label for="smoothing-slider">Сглаживание линий: </label>
                        <div class="slider-container">
                            <span>-</span>
                            <input type="range" id="smoothing-slider" min="0" max="10" value="2">
                            <span id="smoothing-value">2</span>
                            <span>+</span>
                        </div>
                    </div>
                    <div class="setting-row">
                        <label for="transparency-toggle">Отключить прозрачность</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="transparency-toggle">
                            <label for="transparency-toggle"></label>
                        </div>
                    </div>
                    <div class="setting-row">
                        <label for="animations-toggle">Отключить анимации</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="animations-toggle">
                            <label for="animations-toggle"></label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelSettings" class="ps-button">Отмена</button>
                <button id="okSettings" class="ps-button primary">OK</button>
            </div>
        </div>
    </div>
    
    <div id="helpModal" class="modal-overlay hidden">
        <div class="modal-photoshop" style="width: 650px; height: 450px;">
            <div class="modal-sidebar">
                <button class="sidebar-button active" data-panel="general-panel">Введение</button>
                <button class="sidebar-button" data-panel="hotkeys-panel">Горячие клавиши</button>
                <button class="sidebar-button" data-panel="navigation-panel">Навигация</button>
                <button class="sidebar-button" data-panel="objects-panel">Работа с объектами</button>
                <button class="sidebar-button" data-panel="tools-panel">Инструменты</button>
                <button class="sidebar-button" data-panel="advanced-panel">Продвинутые техники</button>
            </div>
            <div class="modal-main">
                <div class="modal-panel active" id="general-panel"></div>
                <div class="modal-panel" id="hotkeys-panel"></div>
                <div class="modal-panel" id="navigation-panel"></div>
                <div class="modal-panel" id="objects-panel"></div>
                <div class="modal-panel" id="tools-panel"></div>
                <div class="modal-panel" id="advanced-panel"></div>
            </div>
            <div class="modal-footer">
                <button id="closeHelpBtn" class="ps-button primary">OK</button>
            </div>
        </div>
    </div>

    <div id="confirmClearModal" class="modal-overlay hidden">
        <div class="modal-photoshop" style="width: 400px; height: auto;">
            <div class="modal-main" style="grid-column: 1 / -1; text-align: center;">
                <h3>Подтверждение</h3>
                <p>Вы уверены, что хотите полностью очистить доску? Это действие нельзя будет отменить.</p>
            </div>
            <div class="modal-footer" style="grid-column: 1 / -1;">
                <button id="cancelClearBtn" class="ps-button">Отмена</button>
                <button id="confirmClearBtn" class="ps-button primary">Очистить</button>
            </div>
        </div>
    </div>

    <div id="lineWidthIndicator"></div>

    <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" data-action="bringForward">Переместить вперед</div>
        <div class="context-menu-item" data-action="sendBackward">Переместить назад</div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" data-action="bringToFront">На передний план</div>
        <div class="context-menu-item" data-action="sendToBack">На задний план</div>
    </div>

    <div id="custom-tooltip"></div>
    
    <script type="module" src="js/main.js"></script>
</body>
</html>